name: Check Package Version
description: Checks if the package version has been updated compared to a specified branch.
author: Arnau Villoro

inputs:
  repository:
    description: Repository to check version in
    required: true
    default: ${{ github.repository }}

  ref:
    description: Branch reference
    required: true
    default: ${{ github.ref }}

  branch:
    description: Branch to compare the version with
    required: false
    default: main

runs:
  using: composite
  steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: Fetch Target Branch
      run: git fetch origin ${{ inputs.branch }} --depth=1
      shell: bash

    - name: Install Dependencies
      run: pip install toml loguru packaging click
      shell: bash

    - name: Run Version Check
      run: python $GITHUB_ACTION_PATH/check_version.py --branch=${{ inputs.branch }}
      shell: bash
